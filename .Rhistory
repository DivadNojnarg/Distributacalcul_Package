library(devtools)
library(devtools) ; library(roxygen2)
load_all()
load_all()
load_all()
load_all()
load_all()
library(MyPackage)
library(TVaRFormulas)
load_all()
load_all()
Fx <- function(x)
{
dnbinom(0, 0.4, 10/11) + sum(sapply(1:1000, function(k) dnbinom(k, 0.4, 10/11) * pgamma(x, k*1.5, 1.5/1000)))
}
Fx(30)
Fx(0)
Fx(50)
Fx(100)
VaRx <- function(k)
{
if (k <= dnbinom(0, 0.4, 10/11))
0
else
optimize(function(x) abs(Fx - k), c(0, 1000))$minimum
}
VaRx(0.95)
Fs <- function(x)
{
dnbinom(0, 80, 10/11) + sum(sapply(1:1000, function(k) dnbinom(k, 80, 10/11) * pgamma(x, k*1.5, 1.5/1000)))
}
Fs(30*200)
Fs(30*200)
Fs(0)
Fs(50*200)
Fs(100*200)
VaRs <- function(k)
{
if (k <= dnbinom(0, 80, 10/11))
0
else
uniroot(function(x) (Fs(x) - k), c(0, 100000))$root
}
optimize(function(x) abs(Fs(x) - k), c(0, 1000000000))$minimum
Fx <- function(x)
{
dnbinom(0, 0.4, 10/11) + sum(sapply(1:1000, function(k) dnbinom(k, 0.4, 10/11) * pgamma(x, k*1.5, 1.5/1000)))
}
Fx(30)
Fx(0)
Fx(50)
Fx(100)
VaRx <- function(k)
{
if (k <= dnbinom(0, 0.4, 10/11))
0
else
optimize(function(x) abs(Fx - k), c(0, 1000))$minimum
}
VaRx(0.95)
Fs <- function(x)
{
dnbinom(0, 80, 10/11) + sum(sapply(1:1000, function(k) dnbinom(k, 80, 10/11) * pgamma(x, k*1.5, 1.5/1000)))
}
Fs(30*200)
Fs(0)
Fs(50*200)
Fs(100*200)
VaRs <- function(k)
{
if (k <= dnbinom(0, 80, 10/11))
0
else
uniroot(function(x) (Fs(x) - k), c(0, 100000))$root
}
optimize(function(x) abs(Fs(x) - k), c(0, 1000000000))$minimum
VaRs(0.99)/200
TVaRs <- function(x)
{
V <- VaRs(x)
(1/(1-x)) * sum(sapply(1:1000, function(k) dnbinom(k, 80, 10/11) * (1.5 * k / (1.5/1000)) * (1 - pgamma(V, 1.5 * k + 1, 1.5/1000))))
}
TVaRs(0.99)/200
optimize(function(x) abs(Fs(x) - k), c(0, 1000000000))$minimum
VaRs(0.99)/200
rm(list = ls())
set.seed(20170222)
u <- runif(100000*qnbinom(0.99, 1.5, 1/3))
M <- numeric(100000)
X <- numeric(100000)
count <- 1
rm(list = ls())
set.seed(20160419)
u <- runif(300000)
X1 <- numeric(100000)
X2 <- numeric(100000)
X3 <- numeric(100000)
for (i in 1:100000)
{
X1[i] <- 50 * (log(1 - u[3*i - 2]))^2
X2[i] <- 20 * ((u[3*i - 1] / (1 - u[3*i - 1]))^(1/2.5))
X3[i] <- ((100/(1 - (u[3*i])^(1/2.5)) - 100)^(1/2))
}
X1[1]
X2[1]
X3[1]
X1[2]
X2[2]
X3[2]
X1[100000]
X2[100000]
X3[100000]
mean(X1)
mean(X2)
mean(X3)
TVaRX1 <- (sum(sort(X1)[90001:100000])) / 10000
TVaRX1
TVaRX2 <- (sum(sort(X2)[90001:100000])) / 10000
TVaRX2
TVaRX3 <- (sum(sort(X3)[90001:100000])) / 10000
TVaRX3
load_all()
library(devtools) ; library(roxygen2)
load_all()
library("TVaRFormulas", lib.loc="~/Library/R/library")
library(devtools) ; library(roxygen2)
load_all()
library(TVaRFormulas)
library(TVaRFormulas)
library(TVaRFormulas)
library(TVaRFormulas)
library(TVaRFormulas)
library(TVaRFormulas)
library(TVaRFormulas)
TVaR_unif(0.9, 10, 15)
TVaR_unif(0.999999, 10, 15)
TVaR_unif(0.999999, 10, 18)
library(devtools) ; library(roxygen2)
load_all()
reload("TVaRFormulas")
library(TVaRFormulas)
library(TVaRFormulas)
library(tvarPackage)
library(tvarPackage)
remove.packages("TVaRFormulas", lib="~/Library/R/library")
library(tvarPackage)
library(tvarPackage)
library(tvarPackage)
VaR_exp(0.99, 1/4000)
VaR_exp(0.99, 1/4000)
system.time(VaR_exp(0.99, 1/4000))
library(tvarPackage)
library(tvarPackage)
SL_exp(300, 1/200)
SL_exp(1000, 1/200)
SL_exp(1000, 1/2000)
SL_exp(100000, 1/2000)
library(tvarPackage)
V_gamma(6, 9)
library(tvarPackage)
V_gamma(6, 9)
library(tvarPackage)
library(tvarPackage)
library(tvarPackage)
library(roxygen2)
library(tvarPackage)
library(devtools)
document()
library(tvarPackage)
document()
document()
library(tvarPackage)
library(roxygen2)
library(devtools)
document()
library(tvarPackage)
?? TvaR_gamma
TVaR_gamma(.99, 3, 5)
TVaR_gamma(0.9, 3, 2)
TVaR_gamma(0.9, 3, 1/1000)
TVaR_gamma(0.9, 1.5, 1/1000)
TVaR_gamma(0.3, 1.5, 1/1000)
TVaR_gamma(0, 1.5, 1/1000)
document()
library(tvarPackage)
document()
shiny::runApp('~/Box Sync/Ulaval/Parascolaire/Programmation/R/shiny_app/ACTFormulas')
runApp('~/Box Sync/Ulaval/Parascolaire/Programmation/R/shiny_app/ACTFormulas')
dbinom(1:10, 10, 0.3)
rbinom(1:10, 10, 0.3)
runApp('~/Box Sync/Ulaval/Parascolaire/Programmation/R/shiny_app/ACTFormulas')
library(tvarPackage)
library(tvarPackage)
document()
library(devtools)
document()
library(devtools)
library(tvarPackage)
document()
V_beta(10, 15)
V_beta(1, 4)
beta(1,4)
beta(1,4)
library(tvarPackage)
library(devtools)
document()
VaR_beta(0.9, 3, 4)
qbeta(0.9, 3, 4)
TVaR_beta(0.9, 3, 4)
library(tvarPackage)
document()
VaR_beta(0.9, 3, 4)
qbeta(0.9, 3, 4)
TVaR_beta(0.9, 3, 4)
